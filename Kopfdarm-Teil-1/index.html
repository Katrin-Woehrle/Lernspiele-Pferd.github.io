<HEAD>
<META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1">
<TITLE>Lernspiel von Katrin Wöhrle</TITLE>
</HEAD>


<script language="JavaScript">
//------------------------------------------------------------------------------
//bildernamen.js
var headlines = new Array();
var i = 0;
//headlines[i++]='<center><font size="-2">Thema 1: Kopfdarm, Lernspiel von Katrin Wöhrle</font></center>';
var zeige_bild_name = false;
var max_zusammenpassende_bilder = 2;
var verdecktes_bild_name = "verdeckt.png";   
var vordefinierte_bilder_namen = new Array();
i = 0;
vordefinierte_bilder_namen[i++] = "kopfdarm_frage_1.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_antwort_1.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_frage_2.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_antwort_2.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_frage_3.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_antwort_3.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_frage_4.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_antwort_4.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_frage_5.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_antwort_5.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_frage_6.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_antwort_6.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_frage_7.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_antwort_7.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_frage_8.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_antwort_8.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_frage_9.png";
vordefinierte_bilder_namen[i++] = "kopfdarm_antwort_9.png";
//---------------------------------------------------------------------------------------------------
//lernspielScript.js
function starte_spiel()
{
    init_neues_spiel();
    mix_images();
}
//----------------------------------------------------------------------------
function beende_spiel()
{
    if (confirm("Willst du das Spiel abbrechen und ein neues starten?"))
    {
        nach_Spieleinstellungen_fragen();
    }
}
//-----------------------   mix_array ()   ------------------------------------
function mix_array (data_array, index_array)
{   
    function combi(data, index)
    {
        this.data  = data;
        this.index = index;
    }
   
    function combi_sort (a, b)
    {        
        var result = -1;
        if (a.data > b.data)
        {
            result = 1;
        }
        else if (a.data == b.data)
        {
            result = 1;
        }
        return result;
    }
    var array_length = data_array.length;
    var sort_array = new Array (array_length);
    var i;
    
    for (i = 0;   i < array_length;   i++)
    {
          sort_array[i] = new combi(data_array[i], index_array[i]);
    }
    sort_array.sort(combi_sort);
 
    for (i = 0;   i < array_length;   i++)
    {
          data_array[i]  = sort_array[i].data;
          index_array[i] = sort_array[i].index;
    }
}
//--------------------------------------------------------------------------
function init_neues_spiel()
{    
    generiere_gemischtes_bild_array();
    init_variablen_vor_neuem_spiel();
    zeichne_html_spiel();
    ausgabe_aktueller_spiel_werte();
 }
//--------------------------------------------------
function generiere_gemischtes_bild_array()
{    
    var step = (akt_kopien > 0) ?  1 : anzahl_zusammenpassende_bilder;
    var hilfs_array   = new Array ();
    var random_array = new Array (anzahl_der_vordefinierten_bilder);
    random_array.length   = 0;   
    hilfs_array.length     = 0;   
   for (i=0; i < (anzahl_der_vordefinierten_bilder - step + 1); i += step)
    {
        random_array[random_array.length]=Math.random();
        hilfs_array[hilfs_array.length]=i;
    }
    mix_array (random_array, hilfs_array);
   
    gemischte_bilder.length   = 0;    
    indexes_array.length  = 0;
    random_array.length   = 0;
    index = 0;
    for (i = 0;   i < (verwendete_bilder / step);   i++)
    {
        for (j = 0;   j <= akt_kopien;   j++)    
        {
            for (k = 0;   k < step;   k++)      
            {
                gemischte_bilder[gemischte_bilder.length] = vordefinierte_bilder_namen[hilfs_array[i] + k];
                indexes_array[indexes_array.length] = index++;
                random_array[random_array.length] = Math.random();
            }
        }
    }
    mix_array (random_array, indexes_array);
} 
//----------------------------------------------------------------------
function init_variablen_vor_neuem_spiel()
{
    akt_spieler    = 1;
    runden_zaehler = 1;
    aufgedeckte_bilder_in_der_runde = 0;
    zuletzt_angeklickt_index.length = 0;
    for (i = 0;   i < anzahl_zusammenpassende_bilder;   i++)
    {
        zuletzt_angeklickt_index[zuletzt_angeklickt_index.length] = -1;
    }
    punkte_des_spielers.length = 0;
    for (i = 0;   i < akt_spieleranzahl;   i++)
    {
        punkte_des_spielers[punkte_des_spielers.length] = 0;
    }
 }
//------------------------------------------------------------------------
function zeichne_html_spiel()
{
    
    schreibe_html_ueberschriften("Memoryspiel: Das Spiel läuft");
    output_fenster.document.write ("<form name=\"form_Game\">\n");
    output_fenster.document.write ("<font size=\"-1\"5>Runde </font> <input type=\"text\" name=\"input_rounds\" size=\"2\" disabled></input> \n");
   
    for (i = 1; i <= akt_spieleranzahl; i++)
    {
        output_fenster.document.write ("<font size=\"-1\">Spieler " + i + ": </font><input type=\"text\" name=\"eingabe_spieler" + i + "\" size=\"3\" disabled></input> \n");
    }
 
     output_fenster.document.write ("<font size=2 color=\"red\">Spieler Nr.<input type=\"text\" name=\"input_akt_spieler\" size=\"2\" disabled></input> ist dran! \n </font>");
   
     output_fenster.document.write ("<input type=\"button\" name=\"button_BeendeSpiel\" value=\"Beende das Memoryspiel\" onClick=\"top.beende_spiel();\">&nbsp;");
  
     output_fenster.document.write ("<font size=1 color=\"black\">Kopfdarm Teil 1, Lernspiel von Katrin Wöhrle</font>");
     output_fenster.document.write ("</form>\n");
    var alt_text;                              
    for (i = 0; i < anzahl_der_bilder; i++)
    {         
         alt_text = "Memoryteil_" + (i+1);
         if (zeige_bild_name == true)
         {
             alt_text += ":_";    
             alt_text += gemischte_bilder[indexes_array[i]];
         }
         output_fenster.document.write ('<img src="' + verdecktes_bild_name + '" height= "195" width="195" border="1" alt="' + alt_text + '" name="image' + i + '" onClick="top.show_hidden_image(this)">');
    }
}
//------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
function ausgabe_aktueller_spiel_werte()
{
    output_fenster.document.form_Game.input_akt_spieler.value = akt_spieler;
    output_fenster.document.form_Game.input_rounds.value = runden_zaehler;
    for (i = 1; i <= akt_spieleranzahl; i++)
    {
        var element_name = "eingabe_spieler" + i;
        var input_elements = output_fenster.document.getElementsByName(element_name);
        if (input_elements)
        {
            if (i == akt_spieler)
            {
                input_elements[0].size = 30;
                if (aufgedeckte_bilder_in_der_runde < anzahl_zusammenpassende_bilder)
                {
                    input_elements[0].value = (aufgedeckte_bilder_in_der_runde + 1) +
                         ". Bild aufdecken!      " + punkte_des_spielers[i - 1];
                }
                else
                {
                    input_elements[0].value =
                         "Aufgedeckte Bilder zudecken.   " + punkte_des_spielers[i - 1];
                }
                input_elements[0].focus();
                input_elements[0].select();
            }
            else
            {
                input_elements[0].size = 3;
                input_elements[0].value = punkte_des_spielers[i - 1];
            }
        }
    }
}
//---------------------------------------------------------------------------
function show_hidden_image (clicked_image)
{
    if (aufgedeckte_bilder_in_der_runde < anzahl_zusammenpassende_bilder)
    {
        var clicked_index = -1;    
        clicked_index = parseInt(clicked_image.name.substr(5,10));
        if (clicked_image.src.search(verdecktes_bild_name) != -1)
        {
            displayed_picture_index = indexes_array[clicked_index];
            output_fenster.document.images[clicked_index].src = gemischte_bilder[displayed_picture_index];
            zuletzt_angeklickt_index[aufgedeckte_bilder_in_der_runde] = clicked_index;
            aufgedeckte_bilder_in_der_runde++;
            if (aufgedeckte_bilder_in_der_runde == anzahl_zusammenpassende_bilder)
            {
                var matching = true;
                for (i = 0;   i < (anzahl_zusammenpassende_bilder - 1);   i++)
                {
                    if (Math.floor(indexes_array[zuletzt_angeklickt_index[i]  ] / anzahl_zusammenpassende_bilder)
                    !=  Math.floor(indexes_array[zuletzt_angeklickt_index[i+1]] / anzahl_zusammenpassende_bilder))
                    {
                        matching = false;
                    }
                }
                if (matching == true)
                {                   
                    punkte_des_spielers[akt_spieler - 1]++;
                    for (i = 0;   i < anzahl_zusammenpassende_bilder;   i++)
                    {                       
                        zuletzt_angeklickt_index[i] = -1;
                    }
                    aufgedeckte_bilder_in_der_runde = 0;
                   
                    var found_images = 0;
                    for (i = 0;   i < akt_spieleranzahl;   i++)
                    {
                        found_images += punkte_des_spielers[i];
                    }
                    found_images *= anzahl_zusammenpassende_bilder;
                    if (found_images == anzahl_der_bilder)
                    {
                        ausgabe_aktueller_spiel_werte();   
                        if (akt_spieleranzahl == 1)
                        {
                            alert ("!!! Herzlichen Glückwunsch !!!\n Du hast alles richtig gefunden. \n Drücke OK um ein neues Spiel zu starten.");
                        }
                        else
                        {
                            alert ("!!! Herzlichen Glückwunsch !!!\n Ihr habt alles richtig gefunden. \n Drückt OK um ein neues Spiel zu starten.");
                        }
                        nach_Spieleinstellungen_fragen();
                        return;
                    }
                }
                else
                {
                    // Bilder passen nicht zusammen: warte einfach auf den nächsten Klick auf ein Bild,
                    // bevor sie wieder verdeckt werden und springe zum nächsten Spieler.
                }
            }
        }
    }   
    else
    {       
        for (i = 0;   i < anzahl_zusammenpassende_bilder;   i++)
        {
            output_fenster.document.images[zuletzt_angeklickt_index[i]].src = verdecktes_bild_name;
            zuletzt_angeklickt_index[i] = -1;
        }
        aufgedeckte_bilder_in_der_runde = 0;
        if (akt_spieler == akt_spieleranzahl)
        {
            akt_spieler = 1;
            runden_zaehler++;
        }
        else
        {
            akt_spieler++;
        }
    }
    ausgabe_aktueller_spiel_werte();
    return;
}
//------------------------------------------------------------------
function mix_images()
{
    random_array = new Array(anzahl_der_bilder);
    index_array  = new Array(anzahl_der_bilder);
    for (i=0; i < anzahl_der_bilder; i++)
    {
        random_array[i] = Math.random();
        index_array[i]  = i;
    }
    mix_array (random_array, index_array);
}  
//---------------------------------------------------------------------------------------------------
function anzahl_der_Spieler_wechselt(new_value)
{
    akt_spieleranzahl = parseInt(new_value);
    nach_Spieleinstellungen_fragen();
}
//---------------------------------------------------
function nach_Spieleinstellungen_fragen()
{
    einstellungsseite_zaehler++;
    schreibe_html_ueberschriften("Lernspiel: Einstellungen");
    
    output_fenster.document.write ("<br><u><b><font size=\"+2\">Thema 1: Kopfdarm</font></b></u><br>");
    output_fenster.document.write ("<br><u><b><font size=\"+1\">Einstellungen für das Spiel</font></b></u>");
    output_fenster.document.write ("<form name=\"form_SpielEinstellungen\">\n");
    output_fenster.document.write ("<br><select name=\"select_AnzahlDerSpieler\" size=\"1\" onChange=\"top.anzahl_der_Spieler_wechselt(document.form_SpielEinstellungen.select_AnzahlDerSpieler.value);\"> \n");
    for (i=1; i <= max_spieler; i++)
    {   
        output_fenster.document.write ('<option value="' + i + '">' + i + '</option>\n');
    }
    output_fenster.document.write ("</select>\n");
    output_fenster.document.form_SpielEinstellungen.select_AnzahlDerSpieler.selectedIndex = akt_spieleranzahl - 1;
    output_fenster.document.write ("Wieviele Spieler spielen mit? <br>\n");
   
    var min_copies = 1;
    if (max_zusammenpassende_bilder >= 2)
    {
        min_copies = 0;
        if (einstellungsseite_zaehler == 1)
        {
            akt_kopien = 0;
        }
    }    
   
    if (akt_kopien == 0)
    {
        anzahl_zusammenpassende_bilder = set_matching_images;               
    }
    else
    {
        anzahl_zusammenpassende_bilder = akt_kopien + 1;
    }
    anzahl_der_bilder = (akt_kopien + 1) * verwendete_bilder;    
    output_fenster.document.write ('<br><input type="button" name="button_SpielStarten" value="Starte das Lernspiel zu Thema 1: Kopfdarm" onClick="top.starte_spiel();"><br>\n');
    output_fenster.document.write ('<br><input type="button" name="button_BilderZeigen" value="Zeige alle Fragen und Antworten" onClick="top.zeige_bilder();"><br>\n');
       
    output_fenster.document.write ("</form>\n");
 } 
//------------------------------------------------------------------------------------------------------------------------
//zeigeBilder.js
//-----------------------   zeige_bilder ()   ---------------------------
function zeige_bilder()
{    
    schreibe_html_ueberschriften("Memoryspiel: Bilder anzeigen");
    output_fenster.document.write ("<form name=\"form_bilder_anzeigen\">\n");
    output_fenster.document.write ("<input type=\"button\" name=\"button_BeendeSpiel\" value=\"Zurück zu den Einstellungen\" onClick=\"top.nach_Spieleinstellungen_fragen();\">\n");
  
    output_fenster.document.write ("</form>\n");
    var alt_text;                              
    for (i = 0; i < anzahl_der_vordefinierten_bilder; i++)
    {         
         alt_text = "Bild_" + (i+1) + ":_" + vordefinierte_bilder_namen[i];
         output_fenster.document.write ('<img src="' + vordefinierte_bilder_namen[i] + '" height= "200" width="200" border="1" alt="' + alt_text + '" name="image' + i + '" >');
    }
    output_fenster.document.write ("</form>\n");
}
//----------------------------------------------------------------------------------------------------------------------------
//variablen.js
var anzahl_der_vordefinierten_bilder = vordefinierte_bilder_namen.length;
var verwendete_bilder = anzahl_der_vordefinierten_bilder;
var anzahl_der_bilder;                 
var gemischte_bilder = new Array();    
var indexes_array = new Array();       
var max_spieler = 4;                   
var akt_spieleranzahl = 1;                   
var akt_spieler;                        
var punkte_des_spielers = new Array(); 
var max_kopien  = 4;                   
var akt_kopien  = 1;                   
var anzahl_zusammenpassende_bilder = max_zusammenpassende_bilder;   
var set_matching_images = anzahl_zusammenpassende_bilder;  
var zuletzt_angeklickt_index = new Array();  
var runden_zaehler;                    
var aufgedeckte_bilder_in_der_runde;            
var einstellungsseite_zaehler = 0;        
// ---------------------   START --------------------------------------------
nach_Spieleinstellungen_fragen();
//-----------------------   schreibe_html_ueberschriften ()   ---------------------------
function schreibe_html_ueberschriften(title_string)
{   
    if (!window.output_fenster)
    {
        document.write ("<frameset  cols=\"*\"><frame src=\"frame_leer.htm\" name=\"output_fenster\"></frameset>");
    }
    output_fenster.document.close();
    output_fenster.document.open ("text/html", "replace");    
    //output_fenster.document.bgColor = "#A0A0FF";
    document.title = title_string;
    for (i = 0;   i < headlines.length;   i++)
    {
        output_fenster.document.write (headlines[i]);
    }
}
</script>

</HTML>
